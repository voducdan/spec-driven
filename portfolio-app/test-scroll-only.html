<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scroll Test Only</title>
    <style>
        body { margin: 0; font-family: Arial, sans-serif; }
        .container { 
            width: 100vw; 
            height: 100vh; 
            background: linear-gradient(135deg, #1e3a8a, #3b82f6);
            overflow: hidden;
        }
        .tasks-layer { 
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            overflow: auto; 
            padding: 50px;
            min-width: 200vw;
            min-height: 200vh;
        }
        .test-task {
            position: absolute;
            width: 200px;
            height: 100px;
            background: white;
            border: 2px solid #ccc;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: transform 0.1s ease;
        }
        .log {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            z-index: 1000;
            max-width: 300px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="tasks-layer" id="tasks-layer">
            <div class="test-task" id="task1" style="left: 100px; top: 100px;">Task 1</div>
            <div class="test-task" id="task2" style="left: 400px; top: 100px;">Task 2</div>
            <div class="test-task" id="task3" style="left: 700px; top: 100px;">Task 3</div>
            <div class="test-task" id="task4" style="left: 1000px; top: 100px;">Task 4</div>
            <div class="test-task" id="task5" style="left: 300px; top: 400px;">Task 5</div>
            <div class="test-task" id="task6" style="left: 600px; top: 400px;">Task 6</div>
        </div>
        <div class="log" id="log">
            Scroll around to test scaling...<br>
        </div>
    </div>

    <script>
        const tasksLayer = document.getElementById('tasks-layer');
        const log = document.getElementById('log');
        
        function addLog(message) {
            console.log(message);
            log.innerHTML += message + '<br>';
            log.scrollTop = log.scrollHeight;
        }
        
        const tasks = [
            { element: document.getElementById('task1'), x: 100, y: 100 },
            { element: document.getElementById('task2'), x: 400, y: 100 },
            { element: document.getElementById('task3'), x: 700, y: 100 },
            { element: document.getElementById('task4'), x: 1000, y: 100 },
            { element: document.getElementById('task5'), x: 300, y: 400 },
            { element: document.getElementById('task6'), x: 600, y: 400 }
        ];
        
        let scrollCount = 0;
        
        function handleScroll() {
            scrollCount++;
            addLog(`Scroll event #${scrollCount}`);
            
            const scrollTop = tasksLayer.scrollTop;
            const scrollLeft = tasksLayer.scrollLeft;
            const viewportHeight = tasksLayer.clientHeight;
            const viewportWidth = tasksLayer.clientWidth;
            const viewportCenterY = scrollTop + viewportHeight / 2;
            const viewportCenterX = scrollLeft + viewportWidth / 2;
            
            const maxDistance = Math.min(viewportHeight, viewportWidth) / 2;
            const minScale = 0.5;
            const centerScale = 1.4;
            
            tasks.forEach(({ element, x, y }, index) => {
                const taskWidth = 200;
                const taskHeight = 100;
                const taskCenterX = x + taskWidth / 2;
                const taskCenterY = y + taskHeight / 2;
                
                const distanceX = Math.abs(viewportCenterX - taskCenterX);
                const distanceY = Math.abs(viewportCenterY - taskCenterY);
                const distance = Math.sqrt(distanceX * distanceX + distanceY * distanceY);
                
                let scale;
                if (distance <= maxDistance / 4) {
                    scale = centerScale;
                } else if (distance >= maxDistance) {
                    scale = minScale;
                } else {
                    const normalizedDistance = (distance - maxDistance / 4) / (maxDistance - maxDistance / 4);
                    scale = centerScale - normalizedDistance * (centerScale - minScale);
                }
                
                element.style.transform = `scale(${scale})`;
                
                const opacity = Math.max(0.6, 1 - (distance / maxDistance) * 0.4);
                element.style.opacity = opacity;
                
                if (index === 0) { // Log only first task to avoid spam
                    addLog(`Task1: scale=${scale.toFixed(2)}, distance=${distance.toFixed(0)}`);
                }
            });
        }
        
        tasksLayer.addEventListener('scroll', handleScroll, { passive: true });
        
        addLog('Scroll test initialized');
        addLog(`Viewport: ${tasksLayer.clientWidth}x${tasksLayer.clientHeight}`);
        addLog(`Scroll area: ${tasksLayer.scrollWidth}x${tasksLayer.scrollHeight}`);
        
        // Initial trigger
        setTimeout(() => {
            addLog('Triggering initial scroll...');
            tasksLayer.scrollBy(100, 100);
        }, 1000);
    </script>
</body>
</html>
